# ProbePRE
Protocol reverse engineering (PRE) is used to infer the protocol formats of unknown protocols. Existing techniques, whether Network-trace based methods or Execution-trace based methods, face two main limitations: dependence on the quality and scale of traffic datasets, leading to low accuracy and insufficient generalization of the results; and failure to adequately consider the multi-format characteristic prevalent in real-world protocols (i.e., the same protocol may support multiple different formats). To address these challenges, we propose ProbePREâ€”a PRE tool that performs multi-format extraction on protocol handlers by autonomously generating packets. ProbePRE employs: (1) an execution tracing strategy enhanced with implicit data flow analysis to obtain more detailed execution information; (2) constraint extraction methods tailored for different program structures to pass protocol validation; and (3) an innovative constraint combination algorithm to construct effective packets that guide the protocol handler to execute different protocol parsing paths.In the experimental evaluation, we compare ProbePRE with four state-of-the-art PRE tools in terms of field segmentation accuracy. The results show that ProbePRE achieves an F1 score of 0.88, significantly outperforming existing methods. Secondly, evaluations on six protocol handlers demonstrate that ProbePRE achieves 83% completeness in multi-format extraction tasks. Notably, in basic block coverage tests, ProbePRE shows an improvement of 67% compared to traditional traffic dataset methods, a result that fully validates the effectiveness of its path exploration.
